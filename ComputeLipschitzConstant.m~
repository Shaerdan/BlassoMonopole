function [LipschitzConst] = ComputeLipschitzConstant(Mesh,PhiComponent,...
    FL2Norm,SourceNumUpdate)
%   Compute L = \int_{Q} A^2(Q) dQ, where A(Q) = \phi(Q)/G_{P_i}; 

D = sin(Mesh.ThetaQ);
dx = Mesh.ThetaQLine';
dy = Mesh.PsiQLine';
AiSquare = zeros(size(PhiComponent));
Ai = AiSpuare;
for i = 1:SourceNumUpdate
    Ai(:,:,i) = PhiComponent(:,:,i)./FL2Norm(i);
end
AiNorm = sqrt(sum(Ai.^2,3));
Integrand = AiNorm.*Ai;
LipschitzConst = sum(trapz(dy,trapz(dx,AiSquare,2)));

end

